# ---------- builder ----------
FROM node:20-alpine AS builder
WORKDIR /app

COPY package*.json ./
RUN if [ -f package-lock.json ]; then npm ci; else npm install --no-audit --no-fund; fi

# ğŸ‘‡ ì´ ë‘ íŒŒì¼ì„ ê¼­ ë³µì‚¬
COPY tailwind.config.js postcss.config.cjs ./

# ë‚˜ë¨¸ì§€ ì•± íŒŒì¼
COPY index.html ./
COPY tsconfig*.json vite.config.ts ./
COPY src ./src
COPY public ./public

RUN npm run build

# ---------- nginx ----------
FROM nginx:1.27-alpine AS runner
WORKDIR /usr/share/nginx/html
COPY --from=builder /app/dist ./